<div class="row">
    <div class="col-md-6">
        <h6 class="text-muted mb-3">Informações do Assinante</h6>
        <p><strong>Username:</strong> @{{ sub.telegram_username or "Sem username" }}</p>
        <p><strong>Telegram ID:</strong> {{ sub.telegram_user_id }}</p>
        <p><strong>Status:</strong>
            <span class="badge bg-{{ 'success' if sub.status == 'active' and sub.end_date > now else 'danger' }}">
                {{ sub.status|capitalize }}
            </span>
        </p>
    </div>
    <div class="col-md-6">
        <h6 class="text-muted mb-3">Assinatura</h6>
        <p><strong>Plano:</strong> {{ sub.plan.name }} - R$ {{ "%.2f"|format(sub.plan.price) }}</p>
        <p><strong>Inicio:</strong> {{ sub.start_date.strftime("%d/%m/%Y") }}</p>
        <p><strong>Expira:</strong> {{ sub.end_date.strftime("%d/%m/%Y") }}
            {% if sub.status == 'active' and days_left > 0 %} ({{ days_left }} dias){% endif %}
        </p>
        <p><strong>Renovação auto:</strong> {{ "Sim" if sub.auto_renew else "Nao" }}</p>
    </div>
</div>

{% if transactions %}
<hr>
<h6 class="text-muted mb-3">Historico de Pagamentos</h6>
<table class="table table-sm">
    <thead><tr><th>Data</th><th>Valor</th><th>Status</th></tr></thead>
    <tbody>
    {% for t in transactions %}
        <tr>
            <td>{{ t.created_at.strftime("%d/%m/%Y %H:%M") }}</td>
            <td>R$ {{ "%.2f"|format(t.amount) }}</td>
            <td><span class="badge bg-{{ 'success' if t.status == 'completed' else 'warning' if t.status == 'pending' else 'danger' }}">{{ t.status|capitalize }}</span></td>
        </tr>
    {% endfor %}
    </tbody>
</table>
{% endif %}
